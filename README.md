![title](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2Faff2a68d-3d21-46fa-9589-63354dd4c528%2F%25EC%25A0%259C%25EB%25AA%25A9_%25EC%2597%2586%25EC%259D%258C.png?table=block&id=56f62e0d-969f-42c6-9d30-83f2d288f1a3&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=2000&userId=&cache=v2)

## ğŸ‘‰ ëª©ì°¨

1. [ ğŸ¬ í”„ë¡œì íŠ¸ ì†Œê°œ]
2. [ ğŸ›  ê¸°ìˆ  ìŠ¤íƒ]
3. [ ğŸ˜™ 'ë°©êµ¬ì„ê°œë°œì' í”„ë¡œì íŠ¸ êµ¬ì„± **ì¸ì›** ë° **TASK**]
4. [ğŸ‘‰ ERD]

</br>

## ğŸ¬ í”„ë¡œì íŠ¸ ì†Œê°œ

-   **ë°©êµ¬ì„ê°œë°œì**ëŠ” **ì´ˆë³´ê°œë°œì**ë¥¼ ìœ„í•´ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.
-   **Q&Aê²Œì‹œíŒ**ì„ í†µí•´ **ì‰½ê²Œ** ì •ë³´ë¥¼ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
-   **TOY PROJECT** êµ¬ì„±ì›ë„ **í¸ë¦¬**í•˜ê²Œ êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</br>

## âœ¨ ë°°í¬ ë§í¬

-   **https://newveloper.com**

</br>

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">
<img src="https://img.shields.io/badge/nestjs-E0234E?style=for-the-badge&logo=nestjs&logoColor=white">
<img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html5&logoColor=white">
<img src="https://img.shields.io/badge/css3-1572B6?style=for-the-badge&logo=css3&logoColor=white">
<img src="https://img.shields.io/badge/typescript-3178C6?style=for-the-badge&logo=typescript&logoColor=white">
<img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black">
<img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
<img src="https://img.shields.io/badge/amazonec2-FF9900?style=for-the-badge&logo=amazonec2&logoColor=white">
<img src="https://img.shields.io/badge/postman-FF6C37?style=for-the-badge&logo=postman&logoColor=white">
<img src="https://img.shields.io/badge/elasticsearch-005571?style=for-the-badge&logo=elasticsearch&logoColor=white">
<img src="https://img.shields.io/badge/OAUTH2.0-4285F4?style=for-the-badge&logo=google&logoColor=white">
<img src="https://img.shields.io/badge/openai-412991?style=for-the-badge&logo=openai&logoColor=white">
<img src="https://img.shields.io/badge/dbeaver-382923?style=for-the-badge&logo=dbeaver&logoColor=white">

</Br>

## ğŸ˜™ 'ë°©êµ¬ì„ê°œë°œì' í”„ë¡œì íŠ¸ êµ¬ì„± **ì¸ì›** ë° **TASK**

| ì´ë¦„   | blog                              | TASK                                                                                                      |
| ------ | --------------------------------- | --------------------------------------------------------------------------------------------------------- |
| ë¯¼ì°¬ê¸° | https://velog.io/@beardevelop     | USER API, ì¸ì¦ ì¸ê°€(Nest Mailer) ë° Multer ì´ìš© ì´ë¯¸ì§€, íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥êµ¬í˜„, ì½”ë“œ ë¦¬íŒ©í† ë§ ë° ëª¨ë“ˆí™”ì‘ì—… |
| ì¡°ë¯¼í¬ | https://minhee5766.tistory.com/   | QnA ê²Œì‹œíŒ ê¸°ë³¸ CRUD API êµ¬í˜„, Elastic Searchë¥¼ ì´ìš©í•œ ê²€ìƒ‰ì—”ì§„ êµ¬í˜„, SSE ì•ŒëŒ êµ¬í˜„, ê²½ê³  ì‹œìŠ¤í…œ API êµ¬í˜„ |
| ë…¸ì‹œì› | https://velog.io/@nohsiwon/posts  | Toy Project ê²Œì‹œíŒ API, ë°ì´í„°ë² ì´ìŠ¤,FE Toy Project í˜ì´ì§€ ë° ë°ì´í„° ì—°ê²° ,FE ì „ë°˜ì ì¸ css ì‘ì—…           |
| ë°•ì§€í˜œ | https://mybluesummer.tistory.com/ | banner, comment CRUD API ê¸°ëŠ¥, multer ì´ˆê¸°ë¡œì§ êµ¬í˜„, FE ë°°ë„ˆ ëœë¤ ì¶œë ¥, SSE ì•Œë¦¼ êµ¬í˜„                     |
| ì´í•œë¹› | https://velog.io/@harley091/posts | QnA ê²Œì‹œíŒ gpt API ì±—ë´‡ êµ¬í˜„, FE ì „ë°˜ì ì¸ ìˆ˜ì •, ë³´ì¡°, AWS ec2 ë°°í¬                                        |

</Br>

## ğŸ‘‰ ERD

![onealog](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2Fbd8982cf-1fc2-4fd6-9af3-9f48367e4231%2Ferd.png?table=block&id=d36e6007-106f-45a9-832a-f593ccd2cbe7&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=2000&userId=&cache=v2)

</Br>

## ğŸ‘‰ ì„œë¹„ìŠ¤ ì•„í‚¤í…ì³

![title](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2F82dd822c-0d7c-4c36-bdd3-928f75bed050%2F%25EC%2584%259C%25EB%25B9%2584%25EC%258A%25A4_%25EC%2595%2584%25ED%2582%25A4%25ED%2585%258D%25EC%25B3%2590.jpg?table=block&id=b2e81983-1eb4-4d9c-bce2-c0d1d2122196&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=1920&userId=&cache=v2)

</Br>

## ğŸ™‹â€â™€ï¸ ê¸°ìˆ ì  ì˜ì‚¬ ê²°ì •

<details>
<summary>ë©”ì¼ ì¸ì¦ì„ ìœ„í•œ NPM ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ íƒ(â€™MAILERâ€™)</summary>
<div markdown="1">

-   ë©”ì¼ ì¸ì¦ VS SMSì¸ì¦ ì—ì„œ ì´ë©”ì¼ ì¸ì¦ì„ ì„ íƒí•œ ì´ìœ 

    **1**. ê°œì¸ì •ë³´ì— ëŒ€í•œ ì •ì±… ì„¤ì •ì¤‘ **ê°œì¸ì •ë³´ë¥¼ ìµœì†Œí™”** í•˜ê¸° ìœ„í•´. (ì´ë¦„, ì—°ë½ì²˜ í•„ìš” X)

    **2**. í”„ë¡œì íŠ¸ ì •ì±…ì—ì„œ ê¸°ëŠ¥ì— ëŒ€í•œ ë¶€ë¶„ì€ **ê°€ë³ê²Œ** ì‚¬ìš©ì´ í•„ìš”í•˜ë©°, íŠ¹ì • ê¸°ëŠ¥ì— ëŒ€í•œ ë¶€ë¶„ë§Œ

         ìµœì†Œí•œì˜ ì¸ê°€ ì¥ì¹˜ê°€ í•„ìš”. í•´ë‹¹ í”„ë¡œì íŠ¸ë¥¼ ì´ìš©í•˜ê¸°ì— ì´ë©”ì¼ ì¸ì¦ì€ í•„ìˆ˜ê°€ ì•„ë‹Œ

         TOYPROJECT ê²Œì‹œíŒ ì´ìš©ì— í•„ìš”í•œ ì¸ì¦ìœ¼ë¡œ ìµœì†Œí•œì˜ **ì„ íƒì  ì¸ê°€**ë¥¼ ì±„íƒ.

1. ì¸ì¦ì— í•„ìš”í•œ ì—°ë½ì²˜ ë° ì‹¤ëª…ì€ ì™„ì „í•œ ê°œì¸ì •ë³´ë¡œì¨, ìœ ì¶œì‹œ í”¼í•´ê°€ í´ ìˆ˜ ìˆì§€ë§Œ ë‹¨ìˆœí•œ

    ì´ë©”ì¼ ì¸ì¦ì„ í†µí•œ í† í° ì „ë‹¬ì—ëŠ” í† í° íƒˆì·¨ì‹œì—ë„ ê°œì¸ ì‹¤ëª… ë° ì •ë³´ê°€ ìœ ì¶œë  ì—¼ë ¤ê°€

    ì ë‹¤ê³  íŒë‹¨.

</div>
</details>

<details>
<summary>ì†Œì…œ ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ í†µí•œ ê°„ë‹¨í•œ íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ â€˜OAUTH 2.0â€™ ë„ì…</summary>
<div markdown="1">

-   ìµœëŒ€í•œ **ê°€ë²¼ìš´** ì»¤ë®¤ë‹ˆí‹° ë° ì„œë¹„ìŠ¤ ì´ìš©ì„ ì´ëŒì–´ ë‚´ê¸° ìœ„í•˜ì—¬ **ì†Œì…œë¡œê·¸ì¸** ê¸°ëŠ¥ì„ ë„ì….

-   **OAUTH2.0**ì„ í†µí•œ íšŒì›ê°€ì… ì‹œ í•´ë‹¹ ì´ë©”ì¼ì— ëŒ€í•œ ì •ë³´ê°€ DATABASEì— ì—†ìœ¼ë©´ Googleì—

-   ê¸°ì¬ëœ ë³¸ì¸ì˜ ì´ë¦„ ë° ë‹‰ë„¤ì„ê³¼ emailë¡œ DBì— ì €ì¥ë˜ê²Œ ë˜ì–´ íšŒì›ê°€ì… > ë¡œê·¸ì¸ ìˆœì¸ ê¸°ì¡´

-   ë°©ì‹ ëŒ€ë¹„ **ê°„ë‹¨í•˜ê³  ê°€ë³**ê²Œ ì„œë¹„ìŠ¤ë¥¼ ê°€ì… ë° ì´ìš©ì´ ê°€ëŠ¥.

-   ì‚¬ìš©ìì˜ ì§ì ‘ì ì¸ ì •ë³´ (Email, password)ë¥¼ ë°›ëŠ” ì‹œìŠ¤í…œì€ ì¤‘ê°„ì— í•´ë‹¹ ì •ë³´ íƒˆì·¨ì‹œì— í”¼í•´ê°€ ë§‰ëŒ€í•´ì§ˆ ìˆ˜ ì‡ìœ¼ë¯€ë¡œ, **ë‹¨ìˆœí•œ ì ‘ê·¼ ê¶Œí•œë§Œ ìœ„ì„** í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬ë˜ëŠ” í‘œì¤€ í”„ë¡œí† ì½œ ì´ìš©

</div>
</details>

<details>
<summary>ê²€ìƒ‰ê¸°ì¤€ ì™„í™”ë¥¼ ìœ„í•œ â€˜Elastic Searchâ€™ ë„ì…</summary>
<div markdown="1">

-   ë‹¤ì–‘í•œ ê²€ìƒ‰ ê¸°ëŠ¥: í’ë¶€í•œ ê²€ìƒ‰ ê¸°ëŠ¥ê³¼ ë‹¤ì–‘í•œ ê²€ìƒ‰ ìš”êµ¬ì‚¬í•­ì„ ì²˜ë¦¬ê°€ëŠ¥

        - Q&Aê²€ìƒ‰ ì‹œ ì •í™•í•œ ë‹¨ì–´, ë„ì–´ì“°ê¸°ë¡œ ì¸í•œ ì—„ê²©í•œ ê²€ìƒ‰ê¸°ì¤€ì€ ì‚¬ìš©ìì˜ í¸ì˜ë¥¼ í•´ì¹ 

          ìš°ë ¤ê°€ ìˆì–´ Full text ê¸°ë°˜ìœ¼ë¡œ ìƒ‰ì¸ë˜ëŠ” elasticsearchë¥¼ ì´ìš©í•œ ê²€ìƒ‰ê¸°ì¤€ì˜ ì™„í™”

-   í™•ì¥ì„±: ìˆ˜í‰ì  í™•ì¥ì´ ê°€ëŠ¥í•˜ë©°, ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ì¶”ê°€í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ì˜ ì„±ëŠ¥ì„ ê°„í¸í•˜ê²Œ í–¥ìƒ

    -   ë°ì´í„° ë° ì‘ì—…ì„ ì—¬ëŸ¬ ë…¸ë“œì— ë¶„ì‚°í•¨ìœ¼ë¡œì¨ ì‹œìŠ¤í…œì€ ë” ë§ì€ íŠ¸ë˜í”½ê³¼ ë°ì´í„°ë¥¼

        ìš©ì´í•˜ê²Œ ì²˜ë¦¬ ê°€ëŠ¥

-   ê°œë°©ì„±: RESTful APIë¥¼ í†µí•´ ë°ì´í„°ì— ì ‘ê·¼í•˜ê³  ìƒí˜¸ì‘ìš©ì„ í•  ìˆ˜ ìˆì–´ ë‹¤ì–‘í•œ í”Œë«í¼ê³¼ ì–¸ì–´ì—ì„œ ì‰½ê²Œ í†µí•© ê°€ëŠ¥

    -   apiëŠ” httpê¸°ë°˜ì´ë©°, json í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ê¸° ë•Œë¬¸ì— ë‹¤ì–‘í•œ í”Œë«í¼ê³¼ ì–¸ì–´ì—ì„œ

        Elastic Searchì™€ í†µí•©ì´ ìš©ì´

</div>
</details>

<details>
<summary>Chat GPT APIë¥¼ ì‚¬ìš©í•œ ìë™ ì‘ë‹µ ì±— ë´‡</summary>
<div markdown="1">

ìë™ ì‘ë‹µ ì±—ë´‡ì„ ChatGPTë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„, íŠ¹ì • ì‹œê°„ì— ëŒ“ê¸€ì´ ê²Œì‹œë˜ì§€ ì•Šì„ ë•Œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤!

Chat GPT APIëŠ” npmì—ì„œë„ ì§€ì›í•˜ì—¬ â€˜openaiâ€™ íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ì œê³µí•´ì£¼ëŠ” ì§€ì¹¨ëŒ€ë¡œ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.

í•´ë‹¹ ëª¨ë¸ë¡œì„œ í† í° ê°€ì„±ë¹„ê°€ ì¢‹ì€ â€˜3.5 turboâ€™ ëª¨ë¸ì„ ì‚¬ìš© ì¤‘ì´ë©°, ì‹¤ì œ 50ê°œ ì´ìƒì˜ ì–¸ì–´ë¥¼ ì§€ì›í•˜ì—¬ ì‚¬ìš©ì ì¹œí™”ì ì¸ ë‹µë³€ì„ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

</div>
</details>

</Br>

## ğŸ«  íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

<details>
<summary>wysiwyg ì ìš© ì‹œ XSSê³µê²©ì— ì·¨ì•½í•œ ë³´ì•ˆ ë¬¸ì œì </summary>
<div markdown="1">

ë¬¸ì œì : ìœ„ì§€ìœ„ê·¸ ì ìš©ì‹œ â€˜í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…(XSS) ê³µê²©â€™ì— ì·¨ì•½

í•´ê²° ë°©ì•ˆ:
![onealog](https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2Fc6e72bd8-fcae-46c9-ba39-66b077dd3174%2F%25ED%258A%25B8%25EB%259F%25AC%25EB%25B8%2594%25EC%258A%2588%25ED%258C%2585.jpg?table=block&id=e828ffc8-6590-4789-802c-de9cc9440e3b&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=2000&userId=d7a2fff5-85a5-477a-a8da-a0992ac08530&cache=v2)

1. HTMLì„ ì´ìŠ¤ì¼€ì´í”„í•¨ìœ¼ë¡œì¨ ì‚¬ìš©ìê°€ ì…ë ¥í•œ HTMLì´ ì‹¤í–‰ë˜ì§€ ì•Šê³  í…ìŠ¤íŠ¸ë¡œ ì²˜ë¦¬í•˜ì—¬

    ë°©ì–´ì ì¸ ì¡°ì¹˜

2. helmetì€ ê¸°ë³¸ì ì¸ ë³´ì•ˆ í—¤ë”ë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•œ ë¯¸ë“¤ì›¨ì–´. ë‹¤ì–‘í•œ ë³´ì•ˆ ì¸¡ë©´ì„ ê°•í™”í•˜ê¸°

    ìœ„í•´ ì‚¬ìš©ë˜ë©° ì¼ë¶€ XSSê³µê²©ì„ ë°©ì§€

</div>
</details>

<details>
<summary>EMAILì¸ì¦ ì‹œ redirection URLì— userId ë…¸ì¶œ</summary>
<div markdown="1">

ë¬¸ì œ ë°œìƒ : email ì¸ì¦ì‹œ ë¦¬ë‹¤ì´ë ‰ì…˜ urlì— ì§ì ‘ì ì¸ url ë…¸ì¶œë¡œ ì¸í•˜ì—¬ íƒ€ì¸ì´ userIdë§Œ ì•Œë©´ ì´ë©”ì¼ ì¸ì¦ì„ ì†ì‰½ê²Œ í•  ìˆ˜ ìˆëŠ” ë¬¸ì œê°€ ë°œìƒ

![onealog](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2Fe62c8c8c-71c1-41ca-939e-1eb7f1ce04fe%2FUntitled.png?table=block&id=29ce951c-7f4b-4cd7-acb5-7d966dca4358&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=2000&userId=&cache=v2)

( ì‹¤ì œë¡œ const url = ë¶€ë¶„ì„ í™•ì¸í•´ë³¸ë‹¤ë©´ verify/${userId} ê°€ ì§ì ‘ì ìœ¼ë¡œ ë…¸ì¶œë˜ì–´ ì´ë¶€ë¶„ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í•´ì•¼ ë‹¤ë¥¸ ìœ ì € í˜¹ì€ ë³¸ì¸ì´ ì„ì˜ì ìœ¼ë¡œ ìˆ˜ì •í•  ìˆ˜ ì—†ëŠ”ì§€ì— ëŒ€í•´ì„œ ê³ ë¯¼í•˜ì˜€ë‹¤)

í•´ê²°ë°©ì•ˆ : ì™„ë²½í•œ í•´ê²°ì€ ì•„ë‹ ìˆ˜ ìˆìœ¼ë‚˜, ì•„ì˜ˆ TOKENê°’ì„ ë³´ë‚´ì£¼ë„ë¡ ì²˜ë¦¬í•˜ì˜€ë‹¤.

![onealog](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2Ff6070116-2024-4e63-8050-5bc8afc8aaf9%2FUntitled.png?table=block&id=d48e8178-6995-49bc-942c-7b6bc0c2e4cb&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=2000&userId=&cache=v2)

ì¤‘ìš”í•œ ì ì€ tokenì—ëŠ” user passwordë“± í•´í‚¹ì˜ ìš°ë ¤ê°€ ìˆëŠ” ì •ë³´ëŠ” ë°°ì œí•œ userIdì™€ emailë§Œì£¼ì–´ userIdì™€ emailì„ ë¹„êµ ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´ ì¸ì¦ì´ ë˜ì§€ì•Šê²Œë” ì²˜ë¦¬ë¥¼ í•˜ì˜€ë‹¤.

\*\* Q. ë‚œìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ì²˜ë¦¬í•  ìˆ˜ë„ ìˆì—ˆëŠ”ë° ê·¸ë ‡ê²Œ í•˜ì§€ ì•Šì€ ì´ìœ ëŠ”?

A. ëœë¤í•œ ìˆ˜ë¥¼ ì§ì ‘ ë§Œë“¤ì–´ ë‚œìˆ˜ë¥¼ DBì— ì§ì ‘ ì €ì¥í•˜ì—¬ ë¹„êµí•˜ëŠ” ë°©ì‹ë„ ê³ ë ¤í•´ ë³¸ ì ì´ ìˆë‹¤.

![onealog](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2F132494e8-d877-42cd-a765-c6335937b788%2FUntitled.png?table=block&id=4386f4fc-0d12-48eb-9d38-81461245facb&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=2000&userId=&cache=v2)

(ëœë¤í•œ í† í°ì„ ë§Œë“¤ì–´ë³´ëŠ”ê±´ ì–´ë–¨ê¹Œ? í•˜ë©°)

ë‹¤ë§Œ ìš°ë¦¬ê°€ ìƒì„±í•˜ëŠ” ì¸ì¦ì— ëŒ€í•œ Tokenê°’ì—ëŠ” ë¯¼ê°í•œ passwordë‚˜ ê°œì¸ì •ë³´ê°€ í¬í•¨ë˜ì–´ìˆì§€ ì•Šìœ¼ë©°, UserIdë¥¼ ë°›ì§€ ì•ŠëŠ” ì´ìœ ëŠ” íƒ€ì¸ì´ ë‚¨ì˜ idì— ì¸ì¦íšŒì› ì ˆì°¨ë¥¼ ë¨¹ì¼ ìˆ˜ ìˆëŠ” ë¶€ë¶„ì´ ë¬¸ì œê°€ ë˜ì—ˆìœ¼ë©° ì‹¤ì œë¡œ ê°œì¸ì •ë³´ê°€ ì—†ëŠ” tokenì´ì§€ë§Œ, íƒ€ì¸ì€ ë‹¤ë¥¸ ìœ ì €ì˜ tokenì„ ì•Œ ìˆ˜ ì—†ëŠ” ë¶€ë¶„ì´ê¸°ì— í† í°ê°’ì„ ëŒë ¤ì£¼ëŠ” ì‹ìœ¼ë¡œ ì²˜ë¦¬í•´ë„ ì²˜í•œ ë¬¸ì œì˜ í•´ê²°ì´ ì¶©ë¶„í•œ ë¶€ë¶„ì´ ìˆì–´ userIdëŒ€ì‹  Tokenê°’ìœ¼ë¡œ ì²˜ë¦¬ë¥¼ í•˜ì—¬ ë¬¸ì œë¥¼ í•´ê²°í•˜ê²Œ ë˜ì—ˆë‹¤.

</div>
</details>

<details>
<summary>ê¸°ì¡´ DBì™€ ì—˜ë¼ìŠ¤í‹± ì„œì¹˜ì™€ ë™ê¸°í™”í•˜ëŠ” ë¬¸ì œì </summary>
<div markdown="1">

ë¬¸ì œì : ê²Œì‹œê¸€ ìƒì„±í•  ë•Œ ë°ì´í„°ë¥¼ ì¸ë±ì‹± í•˜ë„ë¡ ì´ˆë°˜ ì„¤ê³„ë¥¼ í–ˆëŠ”ë° ì´ë ‡ê²Œ ì„¤ì •í•  ê²½ìš°
ì‚¬ìš©ìê°€ ê²Œì‹œê¸€ ìˆ˜ì •,ì‚­ì œë¥¼ í•  ê²½ìš° ì–´ë–»ê²Œ ì—…ë°ì´íŠ¸ë¥¼ í• ì§€ ê³ ë¯¼.
í•´ê²°ë°©ì•ˆ: ê²Œì‹œê¸€ ìˆ˜ì •, ì‚­ì œí•  ë•Œ searchServiceì— ìˆëŠ” í•¨ìˆ˜ì— í•´ë‹¹ ë°ì´í„°ë¥¼ ì…ë ¥í•¨ìœ¼ë¡œì¨
ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ê°€ ë  ìˆ˜ ìˆë„ë¡ ì„¤ì •
// ê²Œì‹œê¸€ ìˆ˜ì •
async update(postId: number, updatePostDto: UpdatePostDto, userId, file: any) {
const { title, content, tag } = updatePostDto;

        const foundPost = await this.postRepository.findOne({
            where: {
                deletedAt: null,
                id: postId,
            },
        });

        if (!foundPost) {
            throw new NotFoundException('í•´ë‹¹ ê²Œì‹œë¬¼ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        }

        if (userId !== foundPost.userId) {
            throw new NotAcceptableException('ìˆ˜ì •í•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.');
        }

        const url = file ? await this.uploadService.uploadFile(file) : null;
        const tagArray = tag.split(',');

        const tags = [];
        for (let i = 0; i < tagArray.length; i++) {
            let existedTag = await this.tagRepository.findOne({
                where: { name: tagArray[i] },
            });

            if (!existedTag) {
                tags.push({ name: tagArray[i] });
            }
            tags.push(existedTag);
        }

        const updatePost = await this.postRepository.save({
            id: postId,
            title,
            content,
            image: url,
            tags,
        });

        this.searchService.update('posts', postId, updatePost);

        return updatePost;
    }

    // ê²Œì‹œê¸€ ì‚­ì œ
    async remove(postId: number, userId) {
        const foundPost = await this.postRepository.findOne({
            where: {
                deletedAt: null,
                id: postId,
            },
        });

        if (!foundPost) {
            throw new NotFoundException('í•´ë‹¹ ê²Œì‹œë¬¼ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        }

        if (userId !== foundPost.userId) {
            throw new NotAcceptableException('ìˆ˜ì •í•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.');
        }

        await this.postRepository.delete(postId);

        this.searchService.remove('posts', postId);

        return foundPost;
    }

</div>
</details>

<details>
<summary>ê°™ì€ ê¸°ëŠ¥ ì‚¬ìš© / ë‹¤ë¥¸ ì—ëŸ¬</summary>
<div markdown="1">

ê°ìì˜ CRUD ë° ê°ìì˜ ì˜ì—­ì—ì„œ ê¸°ëŠ¥ ê°œë°œì„ í•  ë•Œ, ê³µí†µì ìœ¼ë¡œ ì“°ì´ëŠ” ëª¨ë“ˆë“¤ì´ ìˆìœ¼ë‚˜ ê°ì ê°œë°œë¡œ ì¸í•˜ì—¬ ê°™ì€ ê¸°ëŠ¥ì„ í•¨ì—ë„ ë¶ˆêµ¬í•˜ê³  ìƒì´í•œ ì—ëŸ¬ë¡œ git mergeì‹œì— ì—ëŸ¬ë“¤ì´ ë°œìƒí•˜ê¸° ì‹œì‘(ì¶©ëŒ ë° ëª¨ë“ˆ ì—ëŸ¬)

í•´ê²°ë°©ì•ˆ :

![onealog](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2Fd5c50bd7-7f14-4958-a430-0a972a886222%2FUntitled.png?table=block&id=abfe47dc-264e-468a-9b5e-1ce4d7d2ddcf&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=2000&userId=&cache=v2)

ì—˜ë¼ìŠ¤í‹± ì„œì¹˜, multer, oauth, alarm(sse), mailerë“± í˜¹ì‹œëª¨ë¥´ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¶€ë¶„ì´ ìˆìœ¼ë©´

ë¶€í’ˆí™”(ëª¨ë“ˆí™”)ë¥¼ í†µí•˜ì—¬ ê°„í¸í•˜ê²Œ ë‹¹ê²¨ì„œ ì‚¬ìš©í•˜ë©° ì—ëŸ¬ê°€ ë°œìƒì‹œì— ëª¨ë‘ê°€ ë™ì¼í•œ ì—ëŸ¬ì½”ë“œë¥¼ ë³¼ ìˆ˜ ìˆë„ë¡ ì¡°ì¹˜.

</div>
</details>

<details>
<summary>ì—˜ë¼ìŠ¤í‹± ì„œì¹˜ ì—…ë°ì´íŠ¸ ì—ëŸ¬</summary>
<div markdown="1">

ë¬¸ì œ : ê²Œì‹œê¸€ì„ ìˆ˜ì •í•˜ê³  ì—˜ë¼ìŠ¤í‹±ì„œì¹˜ì— ì—…ë°ì´íŠ¸ë¥¼ í•  ë•Œ ì„œë²„ì—ëŸ¬ê°€ ë°œìƒ

ì›ì¸: ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸ í•  ë•Œ ë§ˆë‹¤ tagì˜ íƒ€ì… ë¬¸ì œë¡œ ì—…ë°ì´íŠ¸ê°€ ë˜ì§€
ì•ŠëŠ” ë¬¸ì œê°€ ë°œìƒ

í•´ê²°: ì—˜ë¼ìŠ¤í‹±ì„œì¹˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì–¸ì–´ ì¤‘ í•˜ë‚˜ì¸ 'painless'ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ê²°

![onealog](https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2Fad298c23-9a92-4302-a1ea-966534b408b4%2F%25EC%2597%2598%25EB%259D%25BC%25EC%258A%25A4%25ED%258B%25B1%25ED%258A%25B8%25EB%259F%25AC%25EB%25B8%2594%25EC%258A%2588%25ED%258C%2585.png?table=block&id=283d03ef-89fe-4a9e-b559-67871560884d&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=2000&userId=&cache=v2)

ctx.\_source.remove('tags') ë¥¼ í†µí•˜ì—¬ 'tags' í•„ë“œë¥¼ ì œê±°í•˜ê³ 
ctx.\_source.tags = params.newTags ë¥¼ í†µí•˜ì—¬ ìƒˆë¡œìš´ 'tags' ê°’ì„ í• ë‹¹í•˜ì—¬ í•´ê²°

</div>
</details>

</Br>

## ğŸˆ ì½”ë“œ ìƒ˜í”Œ ë° ì£¼ì„

<details>
<summary>MAILER / NestJs ì´ë©”ì¼ ì¸</summary>
<div markdown="1">

// Mailer config
import { registerAs } from '@nestjs/config';
import { config } from 'dotenv';

config();

// emailì„ ë³´ë‚´ëŠ” ì£¼ì²´ ë° í•´ë‹¹ ì„œë¹„ìŠ¤ì˜ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” config

export default registerAs('mailer', () => ({
smtp: 'smtp.gmail.com',
smtp_id: process.env.GOOGLE_APP_EMAIL,
smtp_pw: process.env.GOOGLE_APP_PASSWORD,
smtp_ssl: true,
smtp_port: 587,
smtp_from_name: '<ë³¸ì¸ì¸ì¦ë§¨>',
smtp_from_email: process.env.GOOGLE_EMAIL,
privkey: 'supertest',
}));

---

// mailer.controller.ts
@Controller('mail')
export class EmailController {
constructor(private readonly emailService: EmailService) {}

    /**
     * ë©”ì¼ ì¸ì¦ ì—”ë“œí¬ì¸íŠ¸
     * @param req
     * @param email
     * @returns
     */

    @UseGuards(AccessTokenGuard)
    @Post('send-verification-email')
    async sendVerificationEmail(
        @Req() req: Request,
        @Body('email') email: string,
    ): Promise<{ message: string }> {
        await this.emailService.sendVerificationEmail(email, req['userId']);

        return { message: 'ì´ë©”ì¼ì„ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡í–ˆìŠµë‹ˆë‹¤.' };
    }

}

---

// mailer.servcie.ts

@Injectable()
export class EmailService {
constructor(
private readonly mailerService: MailerService,
private readonly jwtService: JwtService,
) {}

    /**
     * ì¸ì¦ë©”ì¼ ë°œì†¡( +í† í° ìƒì„±, ë§Œë£Œì‹œê°„ ìƒì„±)
     * @param email
     * @param userId
     */

    async sendVerificationEmail(email: string, userId: number): Promise<void> {
        const token = this.jwtService.sign(
            {
                email,
                id: userId,
            },

            // ë§Œë£Œì‹œê°„ì„ ì¤„ì—¬ì¤„ í•„ìš”ê°€ ìˆìŒ.
            { expiresIn: '1h' },
        );
        // ë¦¬ë‹¤ì´ë ‰ì…˜ urlì— emailê³¼ userIdë§Œ ë°›ëŠ” tokenì„ ìƒì„±í•˜ì—¬ ì¸ì¦ì²˜ë¦¬
        const url = `http:/localhost:3000/auth/verify/${token}`;

        await this.mailerService.sendMail({
            to: email,
            subject: 'ë°©êµ¬ì„ ê°œë°œì íšŒì› ì´ë©”ì¼ ì¸ì¦',
            html: `
            <p>ì•„ë˜ ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ì—¬ ì´ë©”ì¼ ì¸ì¦ì„ ì™„ë£Œí•˜ì„¸ìš”:</p>
            <form action=${url} method="POST">
            <button style="background-color: #4CAF50; color: white; padding: 10px 20px; text-align: center; text-decoration: none; display: inline-block; border-radius: 5px; cursor: pointer;">ì¸ì¦</button>
            </form>
        `,
        });
    }

}

</div>
</details>

<details>
<summary>Google social login (Oauth2.0)</summary>
<div markdown="1">

// google.strategy.ts

import { Injectable } from '@nestjs/common';
import { PassportStrategy } from '@nestjs/passport';
import { Profile, Strategy, VerifyCallback } from 'passport-google-oauth20';
import { User } from 'src/user/entities/user.entity';
import { UserService } from 'src/user/user.service';
import { config } from 'dotenv';
import { AuthService } from './auth.service';
config();

@Injectable()
export class GoogleStrategy extends PassportStrategy(Strategy) {
constructor(
private userService: UserService,
private authService: AuthService,
) {
super({
clientID: process.env.GOOGLE_CLIENT_ID,
clientSecret: process.env.GOOGLE_CLIENT_SECRET,
callbackURL: process.env.GOOGLE_CALLBACK_URL,
scope: ['email', 'profile'],
});
}

// validateì— ëŒ€í•œ ì •ì˜
async validate(
accessToken: string,
refreshToken: string,
profile: Profile,
done: VerifyCallback,
) {
const { id, name, emails } = profile;
console.log(accessToken, '+++++++++++++++++++++++++++++++++++');
console.log(refreshToken, '----------------------------------');
const providerId = id;

        const email = emails[0].value;

        // nickname = Google name ì¹˜í™˜
        const nickname = name.givenName + ' ' + name.familyName;

        const password = 'oauth-password';

        let user = await this.userService.getUserByEmail(email);

        if (!user) {
            user = await this.userService.createUserByGoogle(email, nickname, password, providerId);
        }

        done(null, user);

}

---

// auth.controller.ts

/\*\*
_ êµ¬ê¸€ ë¡œê·¸ì¸ ì£¼ì†Œ
_ @param req
\*/
@Get('to-google')
@UseGuards(GoogleAuthGuard)
async googleAuth(@Request() req) {}

    /**
     * ì§ì ‘ì ì¸ êµ¬ê¸€ ë¡œê·¸ì¸ì„ í†µí•œ ë¦¬ë‹¤ì´ë ‰ì…˜ url ì„¤ì • ë° í† í° ë°˜í™˜ ì½”ë“œ
     * @param req
     * @param res
     * @returns
     */
    @Get('google')
    @UseGuards(GoogleAuthGuard)
    googleAuthRedirect(@Request() req: Request, @Res() res) {
        console.log(req['user']);
        // return this.authService.googleLogin(req);
        const token = this.authService.signToken(req['user'], false);
        res.redirect(`http://localhost:3000/Auth/save-token.html?accessToken=${token}`);
        return token;
    }

---

// auth.service.ts

/\*\*
_ í† í°ë°œê¸‰
_ @param user
_ @param isRefreshToken
_ @returns
\*/

    signToken(user: Pick<User, 'email' | 'id'>, isRefreshToken: boolean) {
        const token = this.jwtService.sign(
            {
                sub: user.id,
                email: user.email,
                id: user.id,
                type: isRefreshToken ? 'refresh' : 'access',
            },
            { expiresIn: isRefreshToken ? '1h' : '1h' },
        );

        return token;
    }

/\*\*
_ êµ¬ê¸€ ë¡œê·¸ì¸
_ @param req
_ @returns
_/

    googleLogin(req) {
        if (!req.user) {
            return ' No user from google';
        }

        return {
            message: ' User information from google',
            user: req.user,
        };
    }

</div>
</details>

<details>
<summary>SSE ì•Œë¦¼ ê¸°ëŠ¥</summary>
<div markdown="1">

// SSE ì•Œë¦¼

@Injectable()
export class AlarmService {
constructor(
@InjectRepository(Alarm)
private readonly alarmRepository: Repository<Alarm>,
) {}

    private alarms$: Subject<any> = new Subject();

    private observer = this.alarms$.asObservable();

    // ì´ë²¤íŠ¸ ë°œìƒ í•¨ìˆ˜
    async emitAlarmAddedEvent(userId: number, title: string, description: string) {
        this.alarms$.next({ userId, title, description });
    }

    // ì´ë²¤íŠ¸ë¥¼ êµ¬ë…í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ SSE ì „ì†¡
    sendAlarmAddedEvent(userId: number): Observable<any> {
        return this.observer.pipe(
            // íŠ¹ì • ê²Œì‹œë¬¼ì˜ ëŒ“ê¸€ë§Œ í•„í„°ë§
            filter((event) => event.userId === userId),
            // ë°ì´í„°ë¥¼ SSE í˜•ì‹ìœ¼ë¡œ ë³€í™˜
            map((event) => {
                return {
                    data: {
                        title: `${event.title}`,
                        description: `${event.description}`,
                    },
                } as MessageEvent;
            }),
        );
    }

    // ì•ŒëŒ í˜•ì„±
    async createAlarm(userId: number, title: string, description: string) {
        // ì•ŒëŒì„ ì—¬ê¸°ì„œ ì €ì¥í•˜ëŠ” ë¡œì§ ì‘ì„±
        const alarm = await this.alarmRepository.save({
            title,
            description,
            userId,
        });
        this.emitAlarmAddedEvent(userId, alarm.title, description)
    }

}

</div>
</details>

<details>
<summary>Elastic Search </summary>
<div markdown="1">

// Elastic Search

@Injectable()
export class SearchService {
constructor(private readonly esService: ElasticsearchService) {}

    // ì¸ë±ì‹±
    async indexPost(index: string, post: any) {
        return await this.esService
            .index({
                index,
                body: post,
            })
            .catch((error) => {
                console.error(
                    'Elasticsearch Create Error:',
                    error,
                    '----------------------------',
                    error.meta.body.error,
                    '----------------------------',
                );
                throw error;
            });
    }

    // ê²€ìƒ‰ ê¸°ë³¸ì…‹íŒ…
    async search(text: string) {
        const { body } = await this.esService.search<any>({
            index: 'posts',
            body: {
                query: {
                    multi_match: {
                        query: text,
                        fuzziness: 1,
                        fields: ['title', 'content', 'tags.name'],
                    },
                },
            },
        });

        const hits = body.hits.hits;
        console.log(body);
        console.log(body.hits);
        return hits.map((item: any) => item._source);
    }

    // ë°ì´í„° ìˆ˜ì •
    async update(index: string, postId: number, post) {
        const newTags = post.tags;

        const script = `
        ctx._source.id='${postId}';
        ctx._source.title='${post.title}';
        ctx._source.content='${post.content}';
        ctx._source.image='${post.image}';
        ctx._source.remove('tags');
        ctx._source.tags = params.newTags;
        ctx._source.updatedAt='${new Date(post.updatedAt).toISOString()}';
        `;

        this.esService
            .updateByQuery({
                index,
                body: {
                    query: {
                        match: {
                            id: postId,
                        },
                    },
                    script: {
                        inline: script,
                        lang: 'painless',
                        params: { newTags: newTags },
                    },
                },
            })
            .catch((error) => {
                console.error(
                    'Elasticsearch Update Error:',
                    error,
                    '----------------------------',
                    error.meta.body.failures,
                    '----------------------------',
                );
                throw error;
            });
    }

    // ë°ì´í„° ì‚­ì œ
    async remove(index: string, postId: number) {
        this.esService.deleteByQuery({
            index,
            body: {
                query: {
                    match: {
                        id: postId,
                    },
                },
            },
        });
    }

    // ë§¤í•‘ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
    async getMapping(index: string) {
        const { body } = await this.esService.indices.getMapping({
            index,
        });

        // í•„ë“œ ë° ë°ì´í„° íƒ€ì… ì •ë³´ ì¶œë ¥
        console.log(body[index]?.mappings.properties);
        return body[index]?.mappings;
    }

}

</div>
</details>

<br>

## ì„¤ì¹˜ë°©ë²•

```
npm install
npm run start:dev
```
